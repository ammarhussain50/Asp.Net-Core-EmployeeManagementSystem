<div class="p-4">
  <div class="flex justify-between mb-4">
    <h1 class="text-xl font-semibold">Employees</h1>

    <button
      (click)="openModal()"
      class="bg-green-500 text-white px-3 py-1 rounded flex items-center gap-1"
    >
      Add
    </button>
  </div>

  <!-- Loader -->
  @if (isLoading) {
    <div class="flex items-center justify-center py-10">
    </div>
  }

  <!-- Table -->
  @if (!isLoading) {
    <table class="w-full border">
      <thead>
        <tr class="bg-gray-200">
          <th class="p-2 border">#</th>
          <th class="p-2 border">Name</th>
          <th class="p-2 border">Email</th>
          <th class="p-2 border">Phone</th>
          <th class="p-2 border">Job Title</th>
          <th class="p-2 border">Gender</th>
          <th class="p-2 border">Department</th>
          <th class="p-2 border">Joining Date</th>
          <th class="p-2 border">Action</th>
        </tr>
      </thead>
      <tbody>
        @for (item of employees; track $index) {
          <tr>
            <td class="p-2 border">{{ $index + 1 }}</td>
            <td class="p-2 border">{{ item.name }}</td>
            <td class="p-2 border">{{ item.email }}</td>
            <td class="p-2 border">{{ item.phone }}</td>
            <td class="p-2 border">{{ item.jobTitle }}</td>
            <td class="p-2 border">{{ item.gender === 1 ? 'Male' : 'Female' }}</td>
            <td class="p-2 border">{{ item.department?.name || 'N/A' }}</td>
            <td class="p-2 border">
              {{ item.joiningDate | date: 'yyyy-MM-dd' }}
            </td>
            <td class="p-2 border">
              <button
                (click)="editEmployee(item)"
                class="bg-blue-500 text-white px-2 py-1 rounded flex items-center gap-1"
              >
                Edit
              </button>

              <button
                (click)="deleteEmployee(item.id)"
                class="bg-red-500 text-white px-2 py-1 rounded ml-2 flex items-center gap-1"
              >
                Delete
              </button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  }

  <!-- Modal -->
  @if (showModal) {
    <div
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center"
    >
      <div class="bg-white p-4 rounded w-96">
        <h2 class="text-lg mb-3">
          {{ editId === 0 ? 'Add Employee' : 'Edit Employee' }}
        </h2>

        <form (ngSubmit)="editId === 0 ? saveEmployee() : updateEmployee()">
          <input
            type="text"
            [(ngModel)]="employeeObj.name"
            name="name"
            placeholder="Name"
            class="border p-2 w-full mb-3"
          />

          <input
            type="email"
            [(ngModel)]="employeeObj.email"
            name="email"
            placeholder="Email"
            class="border p-2 w-full mb-3"
          />

          <input
            type="text"
            [(ngModel)]="employeeObj.phone"
            name="phone"
            placeholder="Phone"
            class="border p-2 w-full mb-3"
          />

          <input
            type="text"
            [(ngModel)]="employeeObj.jobTitle"
            name="jobTitle"
            placeholder="Job Title"
            class="border p-2 w-full mb-3"
          />

          <select
            [(ngModel)]="employeeObj.gender"
            name="gender"
            class="border p-2 w-full mb-3"
          >
            <option [value]="1">Male</option>
            <option [value]="2">Female</option>
          </select>

          <div class="text-right">
            <button
              type="button"
              (click)="closeModal()"
              class="bg-gray-300 px-3 py-1 rounded mr-2 flex items-center gap-1"
            >
              Cancel
            </button>

            <button
              type="submit"
              class="bg-green-500 text-white px-3 py-1 rounded flex items-center gap-1"
            >
              Save
            </button>
          </div>
        </form>
      </div>
    </div>
  }
</div>
